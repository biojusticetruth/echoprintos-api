<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EchoprintOS â€” Verify & Generate</title>
  <link rel="stylesheet" href="/ledger/assets/css/base.css" />
  <style>
    body{font:16px/1.4 -apple-system,BlinkMacSystemFont,Segoe UI,Inter,Arial}
    main{max-width:860px;margin:24px auto;padding:0 16px}
    h1{font-weight:700;margin:8px 0 20px}
    .pane{border:1px solid #e5e7eb;border-radius:12px;padding:18px 16px;margin:18px 0}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    input,textarea,button{font:inherit}
    input,textarea{width:100%;border:1px solid #d1d5db;border-radius:10px;padding:10px 12px}
    button{border:1px solid #cbd5e1;border-radius:10px;padding:10px 14px;background:#fff}
    button.primary{background:#111;color:#fff;border-color:#111}
    .cards{display:grid;grid-template-columns:1fr;gap:12px}
    .card{border:1px solid #e5e7eb;border-radius:12px;padding:12px}
    .card header{display:flex;justify-content:space-between;gap:12px;align-items:center}
    .meta{display:grid;grid-template-columns:auto 1fr;gap:6px 10px;margin:8px 0 10px}
    .meta dt{color:#6b7280}
    nav.actions{display:flex;gap:8px;flex-wrap:wrap}
    dialog{border:none;border-radius:12px;padding:0;max-width:720px;width:min(92vw,720px)}
    .modal{padding:14px 16px}
    .close{float:right}
    small.mono{font-family:ui-monospace,SFMono-Regular,Menlo,monospace}
  </style>
</head>
<body>
  <main>
    <h1>ðŸ”Ž EchoprintOS â€” Verify & Recent</h1>

    <!-- GENERATE -->
    <section class="pane" id="generate">
      <h2>Generate (hash + Bitcoin stamp)</h2>
      <div class="row">
        <input id="g-title" placeholder="Title (required)"/>
        <input id="g-permalink" placeholder="Permalink (optional â€” where this lives)"/>
        <input id="g-media" placeholder="Media URL (optional â€” image/video link)"/>
      </div>

      <h3>Hash from TEXT</h3>
      <textarea id="g-text" rows="4" placeholder="Paste any content to hashâ€¦"></textarea>
      <div class="row">
        <button id="btnHashText">Hash Text â†’ SHA-256</button>
      </div>

      <h3>Hash from FILE</h3>
      <div class="row">
        <input type="file" id="g-file" />
        <button id="btnHashFile">Hash File â†’ SHA-256</button>
      </div>

      <h3>Use existing 64-hex hash</h3>
      <div class="row">
        <input id="g-hash" placeholder="ac5c01f3â€¦ (64 hex)"/>
      </div>

      <div class="row">
        <button id="btnInsert" class="primary">Insert (+ Bitcoin stamp)</button>
        <button id="btnClear">Clear</button>
      </div>

      <p id="g-status"></p>
    </section>

    <!-- VERIFY -->
    <section id="verify" class="pane">
      <h2>Verify</h2>
      <form id="verify-form" class="row" onsubmit="return false;">
        <input id="verify-input" inputmode="text" autocomplete="off"
               placeholder="Enter EchoprintOS Record ID (ECP-â€¦) or 64-hex hash" />
        <button id="verify-btn" class="primary" type="submit">Verify</button>
        <button id="recent-btn" type="button">Recent</button>
        <button id="clear-btn" type="button">Clear</button>
      </form>
      <div id="verify-result"></div>
    </section>

    <!-- RECENT -->
    <section id="recent" class="pane">
      <h2>Recent</h2>
      <div id="recent-list" class="cards"></div>
    </section>
  </main>

  <!-- Card template -->
  <template id="card-template">
    <article class="card">
      <header>
        <h3 class="title"></h3>
        <small class="ecp mono"></small>
      </header>

      <dl class="meta">
        <dt>Hash</dt><dd class="hash mono"></dd>
        <dt>Timestamp</dt><dd class="ts mono"></dd>
      </dl>

      <nav class="actions">
        <button class="open-post"      hidden>Open post</button>
        <button class="view-image"     hidden>View image</button>
        <button class="open-in-verify">Open in Verify</button>
        <button class="view-cert">View certificate</button>
        <button class="download-json">Download JSON</button>
        <button class="download-cert">Download certificate</button>
      </nav>
    </article>
  </template>

  <!-- Certificate modal -->
  <dialog id="cert-modal"><div class="modal">
    <button class="close" onclick="this.closest('dialog').close()">âœ•</button>
    <h3>Certificate</h3>
    <pre id="cert-pre" style="white-space:pre-wrap"></pre>
  </div></dialog>

<!-- Load environment (Supabase URL + anon key) -->
<script src="/ledger/env.js?v=37"></script>
<script type="module" src="/ledger/app.js?v=37"></script>
</body>
</html>
