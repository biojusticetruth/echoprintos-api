<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EchoprintOS Â· BioJustice</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">

  <!-- Theme -->
  <link rel="stylesheet" href="./theme.css" />

  <!-- Supabase + helpers -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/html-to-image@1.11.11/dist/html-to-image.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

  <!-- âš™ï¸ Put your Supabase URL & anon key here -->
  <script>
    window.ECP_CONFIG = {
      SUPABASE_URL: "https://YOUR-PROJECT.supabase.co",
      SUPABASE_ANON_KEY: "YOUR-ANON-KEY"
    };
  </script>
</head>

<body>
  <header class="site-header">
    <div class="brand">
      <span class="sprout" aria-hidden="true">ðŸŒ±</span>
      <div>
        <h1 class="title">EchoprintOS</h1>
        <div class="subtitle">Justice nurtured by care</div>
      </div>
    </div>
    <nav class="nav">
      <a href="#generate" class="pill">Generate</a>
      <a href="#verify" class="pill">Verify</a>
      <a href="#feed" class="pill">Live Feed</a>
    </nav>
  </header>

  <main class="container">
    <!-- GENERATE -->
    <section id="generate" class="card">
      <h2 class="card-title">Generate</h2>
      <p class="muted">Create a SHA-256 hash from text or a file. Your record is timestamped in UTC and saved to the ledger.</p>

      <div class="grid">
        <label class="field">
          <span>Title</span>
          <input id="g-title" type="text" placeholder="Untitled" />
        </label>

        <label class="field">
          <span>Permalink (optional)</span>
          <input id="g-link" type="url" placeholder="https://â€¦" />
        </label>

        <label class="field">
          <span>Media URL (optional)</span>
          <input id="g-media" type="url" placeholder="https://â€¦/image.jpg" />
        </label>
      </div>

      <label class="field">
        <span>Text to hash (SHA-256) â€” you can also choose a file below</span>
        <textarea id="g-text" rows="4" placeholder="Paste any content to hashâ€¦"></textarea>
      </label>

      <div class="row">
        <label class="file">
          <input id="g-file" type="file" />
          <span class="btn secondary">Choose File</span>
          <span id="g-file-name" class="file-name">No file selected</span>
        </label>

        <button id="btn-generate" class="btn primary">Generate</button>
      </div>

      <div id="generate-result"></div>
    </section>

    <!-- VERIFY -->
    <section id="verify" class="card">
      <h2 class="card-title">Verify</h2>
      <p class="muted">Enter an <strong>ECP-â€¦</strong> ID or a full 64-hex hash.</p>

      <div class="grid">
        <label class="field">
          <span>ECP ID or SHA-256</span>
          <input id="v-input" type="text" placeholder="ECP-XXXXXXXXXXXX or 64-hexâ€¦" />
        </label>
      </div>

      <div class="row">
        <button id="btn-verify" class="btn primary">Verify</button>
        <button id="btn-clear" class="btn ghost">Clear</button>
      </div>

      <div id="verify-result"></div>
    </section>

    <!-- FEED -->
    <section id="feed" class="card">
      <div class="card-head">
        <h2 class="card-title">Live Feed</h2>
        <div class="muted">Auto-refreshes every 25s</div>
      </div>
      <div id="feed-list" class="stack"></div>
      <div class="row">
        <button id="btn-more" class="btn ghost">More</button>
      </div>
    </section>
  </main>

  <!-- CERTIFICATE MODAL (opens only when user taps â€œView Certificateâ€) -->
  <dialog id="cert-modal" class="modal">
    <div class="cert-wrap">
      <button id="cert-close" class="close" aria-label="Close">Ã—</button>
      <div id="cert-art" class="cert-art">
        <div class="cert-sprout">ðŸŒ±</div>
        <div class="cert-heading">Echoprint Certificate</div>
        <figure class="cert-figure">
          <img id="cert-image" alt="" style="display:none;">
          <figcaption id="cert-quote" class="cert-quote"></figcaption>
          <div class="cert-mark">BioJustice Institute</div>
        </figure>
        <div class="cert-meta">
          <div><strong>Record ID</strong> <span id="c-ecp"></span></div>
          <div><strong>SHA-256</strong> <span id="c-hash"></span></div>
          <div><strong>Timestamp (UTC)</strong> <span id="c-time"></span></div>
        </div>
      </div>

      <div class="row center">
        <button id="dl-png" class="btn secondary">Download Certificate (.png)</button>
        <button id="dl-json" class="btn ghost">Download Data (.json)</button>
        <button id="dl-both" class="btn ghost">Download Both (.zip)</button>
      </div>
    </div>
  </dialog>

  <footer class="site-footer">
    Verified by EchoprintOS provenance ledger
  </footer>

  <script src="./app.js"></script>
</body>
</html>
